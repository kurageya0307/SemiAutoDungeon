# 概要

「KURAGE_SemiAutoDungeon.js」はめんどくさいダンジョン作成を半自動化し，短時間で大量の自然なダンジョンを作ってくれます。
これを使うことで今までダンジョン作成に費やしていた時間を短縮でき，その分システムやシナリオに力を入れることができますよ！

# 使い方

このプラグインの大まかな使い方は以下のとおりです。
1. プラグインを用意する。
2. 「素材マップ」「ダンジョンテンプレマップ」を作成する。
3. テストプレイを実行しプラグインコマンド「KURAGE_SemiAutoDungeon」を実行する。
4. 一度，RPGツクールMVを終了する。
5. dataフォルダにマップデータが作成されているので，既存のマップデータと置き換える。
6. 再度，RPGツクールMVを起動して出来上がり！

使い方の詳細を以下に説明していきます。

## 1.プラグインの用意
このページの上部にある緑色のボタンをクリックしZIPファイルをダウンロードしてください。
ZIPファイルを解答し，「KURAGE_SemiAutoDungeon.js」をRPGツクールMVのプロジェクトのpluginフォルダへ，「__SwapMap.bat」をdataフォルダに保存してください。
RPGツクールMVを起動し，プラグインを読み込んでください（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/PLUGIN.png)

この時点でプラグインパラメータの設定は特に必要ありません。

## 2.「素材マップ」「ダンジョンテンプレマップ」の作成
「素材マップ」「ダンジョンテンプレマップ」の2種類のマップを作成します。
素材マップとダンジョンテンプレマップは，素材マップが親・ダンジョンテンプレマップが子となるようにマップツリーを構成してください（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/MAPTREE.png)

### 素材マップ
ダンジョンを構成する要素を並べた素材マップを作成します（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/SOZAI.png)

素材マップは以下の規格のとおり素材を配置してください。

Y座標　：　素材内容

0　　　：　「床」「壁」「天井」
1　　　：　通行可能でオートタイルで塗りつぶしするタイプの床（例：「床の苔」「床の汚れ」「毒の沼」など）
2　　　：　通行可能で床に置くタイプのオブジェクト（例：「砂利」「草」など）
3　　　：　通行不可能で床に置くタイプの1x1サイズのオブジェクト（例：「岩」「掘られた床」など）
4～5 　：　通行不可能で床に置くタイプの1x2サイズのオブジェクト（例：「大きな岩」「石像」など）
6　　　：　1x1サイズの壁の飾り（例：「壁の苔」など）
7～8 　：　1x2サイズの壁の飾り（例：「壁のツタ」など）

### ダンジョンテンプレマップ
通路のみで構成されるダンジョンテンプレマップを作成します（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/TEMPLATE.png)

上図にあるとおり，ダンジョンテンプレマップは以下の規格に則って作成してください。
1. 通路の幅は3マス以上
2. 通路と通路の間の空間は6マス以上
3. マップの最外周と通路の間のマージンは3マス以上（出入り口を除く）

### プラグインパラメータの設定
作成した素材マップのマップIDをプラグインパラメータ「素材マップID」に入力してください（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/PLUGIN_PARAMETER.png)

素材マップはコンマ区切りで複数入力することができます。

## 3.テストプレイ
どこでもよいのでマップにイベントを用意し，プラグインコマンド「KURAGE_SemiAutoDungeon」を呼び出してください（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/CALL_COMMAND.png)

テストプレイを実行し，F8キーを押してコンソール画面を開いてください。
プラグインコマンドを呼び出すとマップの生成が始まり，途中経過をコンソール画面に出力します（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/CONSOLE.png)

## 4.ツクールMVの一時終了
一度，ツクールMVを終了します。

## 5.dataフォルダの操作
プラグインコマンドを実行することでdataフォルダ内に「_Map***.json」というファイルが作成されています。
これはダンジョンテンプレマップのデータであるMap***.jsonを元にプラグインが生成したマップです。
先頭のアンダーバーを取り除き，Map***.jsonとすることでRPGツクールMVで読み込むことができるようになります。

Windows環境であれば「__SwapMap.bat」をdataフォルダに保存しダブルクリックして実行することで，全ての「_Map***.json」を「Map***.json」に置き換えてくれます（元のMap***.jsonは_Map***.jsonとして保存されます。つまりファイル名のスワップを行っているわけです。）

## 6.ツクールMVの再起動
Map***.jsonを置き換えたならば，再度RPGツクールMVを起動します。
ダンジョンが自動生成されたものに置き換わっていると思います。
生成されたダンジョンを修正するもよし，そのまま使うもよし，ご自由にご使用ください。

# その他の設定
ダンジョンテンプレマップのリージョン設定にてリージョンID「1」を配置すると，配置されたリージョン内に移動不可のオブジェクトを置かないようにできます。
これは主にダンジョンの出入り口付近に配置し，「別のマップから移動してきたあと移動不可オブジェクトの上に乗ってしまい動けなくなってしまう」という現象を避けるために使用します（下図）。
![alt text](https://github.com/kurageya0307/SemiAutoDungeon/blob/pictures/REGION.png)

リージョンIDはプラグインパラメータによって変更することもできます。

# ライセンス
本プラグインはMITライセンスです。
ヘッダー部に著作権表示とMITライセンスのURLを書いていただければ，
自由に改変，使用（非商用・商用・R-18何でも可）していただいて問題ありません。
（ですが，実際のところ配布物に含めることはないんじゃないかなぁ，と思っています。テストプレイでダンジョン生成後，プラグインからは削除するんじゃないかと。その場合，プラグインの使用報告，改造報告，著作権表示，ライセンス表記などは一切不要です。ご自由にご使用ください。）
